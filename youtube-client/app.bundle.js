!function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);class r{constructor(e){this.props=e,this.options={countClips:15,clipsUrl:"https://www.googleapis.com/youtube/v3/search?&type=video&part=snippet",clipStatisticUrl:"https://www.googleapis.com/youtube/v3/videos?part=statistics"}}static extractStatistic(e){return e.items[0].statistics}static async getClipStatistic(e,t){const{apiKey:s,clipStatisticUrl:n}=t,i=`${n}&id=${e}&key=${s}&maxResults=1`;return(await fetch(i).then(e=>{if(200!==e.status)throw new Error(`Response status ${e.status}`);return e.json()}).then(e=>r.extractStatistic(e)).catch(e=>e)).viewCount}static async extractData(e,t){const s=e.nextPageToken;return{clips:await Promise.all(e.items.map(async e=>({id:e.id.videoId,title:e.snippet.title,description:e.snippet.description,thumbnailsUrl:e.snippet.thumbnails.high.url,uploadDate:e.snippet.publishedAt.slice(0,10),clipOwner:e.snippet.channelTitle,viewCount:await r.getClipStatistic(e.id.videoId,t)}))),nextPageId:s}}async getClips(){const{searchTarget:e,apiKey:t,nextPageToken:s}=this.props,{clipsUrl:n,countClips:i,clipStatisticUrl:a}=this.options,o=`${n}&maxResults=${i}&q=${e}&key=${t}&pageToken=${s||""}`,c=await fetch(o),l=await c.json();return await r.extractData(l,{clipStatisticUrl:a,apiKey:t})}}var n=class{constructor(e){this.props=e}render(){const{submitForm:e}=this.props,t=document.createElement("form"),s=document.createElement("input"),r=document.createElement("button");return s.setAttribute("placeholder","Enter video..."),s.setAttribute("type","text"),r.innerText="Search",r.setAttribute("type","submit"),t.insertBefore(s,null),t.insertBefore(r,null),t.classList.add("search-form"),t.addEventListener("submit",e,!1),t}};var i=class{constructor(e){this.props=e}render(){const{title:e,description:t,id:s,thumbnailsUrl:r,uploadDate:n,viewCount:i,clipOwner:a}=this.props,o=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),p=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),m=document.createElement("a");return o.classList.add("clip"),c.classList.add("clip__head"),l.classList.add("clip__body"),p.classList.add("clip__img"),d.classList.add("clip__description"),u.classList.add("clip__statistic"),m.setAttribute("href",`https://www.youtube.com/watch?v=${s}`),p.innerHTML=`<img src='${r}' alt='${e}'/>`,d.innerHTML=`<h3>${e}</h3><p>${t}</p>`,u.innerHTML=`<div>Author: ${a}</div>\n                                <div>Upload date: ${n}</div>\n                                <div>Views: ${i}</div>`,m.innerHTML="<span>View on Youtube</span>",o.appendChild(c),o.appendChild(l),c.appendChild(p),c.appendChild(d),l.appendChild(u),l.appendChild(m),o}};var a=class{constructor(e){this.props=e}render(){const[...e]=this.props,t=document.createElement("div");return t.classList.add("slide"),e.forEach(e=>{const s=new i(e);t.appendChild(s.render())}),t}static renderClipsToLastSlide(e){const t=document.querySelector(".slider").lastChild;e.forEach(e=>{const s=new i(e);t.appendChild(s.render())})}};class o{constructor(e){this.props=e}render(){const{clips:e,props:t,clipsInSlide:s}=this.props,r=o.getSlidesNodes(e.clips,s),n=document.createElement("div");return n.classList.add("slider"),r.forEach(e=>n.appendChild(e)),n.addEventListener("mousedown",t.scrollSlider,!1),n.addEventListener("touchstart",t.scrollSlider,!1),n}static renderNextSlides(e,t){const s=o.getSlidesNodes(e,t),r=document.querySelector(".slider");s.forEach(e=>r.appendChild(e))}static getSlidesNodes(e,t){const s=[];if(o.isRenderClipsInLastSlide(t)){const s=document.querySelector(".slider").lastChild,r=t-s.childElementCount%t,n=e.splice(0,r);a.renderClipsToLastSlide(n)}for(let r=0;r<Math.ceil(e.length/t);r+=1){const n=e.filter((e,s)=>r*t<=s&&s<(r+1)*t),i=new a(n);s.push(i.render())}return s}static isRenderClipsInLastSlide(e){const t=document.querySelector(".slider");return!!t&&t.lastChild.childElementCount%e!=0}}var c=o;var l=class{constructor(e){this.props=e}render(){const{props:e}=this.props,t=document.createElement("div"),s=document.createElement("button"),r=document.createElement("button"),n=document.createElement("button"),i=document.createElement("button");return t.classList.add("pagination-wrapper"),s.classList.add("page_firs"),r.classList.add("page_current"),n.classList.add("page_next"),i.classList.add("page_prev"),s.innerHTML="<span>1</span>",r.innerHTML=`<span>${e.page}</span>`,n.innerText="next",i.innerText="prev",t.appendChild(i),t.appendChild(s),t.appendChild(r),t.appendChild(n),s.addEventListener("click",e.scrollToFirstPage,!1),n.addEventListener("click",e.scrollToNextPage,!1),i.addEventListener("click",e.scrollToPrevPage,!1),t}static setCurrentPage(e){document.querySelector(".page_current span").innerText=e}};class p{constructor(e){this.props=e}render(){const e=document.createElement("header"),t=document.createElement("section"),s=document.createElement("footer"),r=new n(this.props);e.innerHTML="<h1>YouTube search App</h1>",s.innerHTML="<p>&copy Create by Vitali Hantarenka</p>",t.classList.add("app-wrapper"),document.body.appendChild(e),document.body.appendChild(t),document.body.appendChild(s),e.appendChild(r.render())}static renderSlider(e){const t=document.querySelector(".app-wrapper"),s=e;s.clipsInSlide=p.setClipsInSlide();const r=new c(s),n=new l(s);p.checkContainsSlider()&&(p.removeDOMElem(document.querySelector(".slider")),p.removeDOMElem(document.querySelector(".pagination-wrapper"))),t.appendChild(r.render()),t.appendChild(n.render())}static renderNextClips(e){const t=p.setClipsInSlide();c.renderNextSlides(e,t)}static checkContainsSlider(){return!!document.querySelector(".slider")}static removeDOMElem(e){e.parentNode.removeChild(e)}static setCurrentPage(e){l.setCurrentPage(e)}static setClipsInSlide(){return document.body.offsetWidth>1200?4:document.body.offsetWidth>950?3:document.body.offsetWidth>670?2:1}}var d=p;class u{constructor(){this.props={apiKey:"AIzaSyCTWC75i70moJLzyNh3tt4jzCljZcRkU8Y",submitForm:u.submitForm.bind(this),scrollSlider:u.scrollSlider.bind(this),scrollToFirstPage:u.scrollToFirstPage.bind(this),scrollToPrevPage:u.scrollToPrevPage.bind(this),scrollToNextPage:u.scrollToNextPage.bind(this),searchTarget:null,nextPageToken:null,page:1}}static async submitForm(e){e.preventDefault();const t=e.target.querySelector("input").value.trim();if(""===t)return;const{props:s}=this;s.searchTarget=t;const r=await u.getClips(s);s.nextPageToken=r.nextPageId,d.renderSlider({clips:r,props:s})}start(){new d(this.props).render()}static async getClips(e){const t=new r(e);return await t.getClips()}static async getNextClips(e){const{props:t}=e,s=new r(t),n=await s.getClips(),{clips:i,nextPageId:a}=n;t.nextPageToken=a,d.renderNextClips(i)}static isLoadNextClips(e,t){return t===e.childElementCount-2}static scrollToFirstPage(){document.querySelector(".slider").style.setProperty("transform","translateX(0px)"),this.props.page=1,d.setCurrentPage(this.props.page)}static scrollToPrevPage(){const e=document.querySelector(".slider"),t=e.offsetWidth;1!==this.props.page&&(this.props.page-=1,d.setCurrentPage(this.props.page),e.style.setProperty("transform",`translateX(-${t*(this.props.page-1)}px)`))}static scrollToNextPage(){const e=this,t=document.querySelector(".slider"),s=t.offsetWidth;e.props.page+=1,d.setCurrentPage(e.props.page),t.style.setProperty("transform",`translateX(-${s*(e.props.page-1)}px)`),u.isLoadNextClips(t,e.props.page)&&u.getNextClips(e)}static scrollSlider(e){const t=e.type,s=this,r=e.target.closest(".slider"),n=r.offsetWidth,i=r.style.getPropertyValue("transform")||"translateX(0px)",a=+(o=i).slice(o.indexOf("(")+1,o.indexOf(")")-2);var o;let c=null,l=null;function p(){"mousedown"===t?(r.removeEventListener("mousemove",v),r.removeEventListener("mouseleave",f),r.removeEventListener("mouseup",y)):(r.removeEventListener("touchmove",v,!1),r.removeEventListener("touchend",y,!1),r.removeEventListener("touchcancel",f,!1))}function m(){r.style.setProperty("transform",`translateX(${a}px)`)}function h(e){return e<0}function g(){var e;e=l,n/2<Math.abs(e)?function(){if(h(l))s.props.page+=1,d.setCurrentPage(s.props.page),u.isLoadNextClips(r,s.props.page)&&u.getNextClips(s);else{if(!h(l)&&1===s.props.page)return void m();s.props.page-=1,d.setCurrentPage(s.props.page)}r.style.setProperty("transform",`translateX(-${n*(s.props.page-1)}px)`)}():m()}function v(e){e.preventDefault();const t=(e.changedTouches?e.changedTouches[0]:e).pageX-r.offsetLeft;l=t-c,r.style.setProperty("transform",`translateX(${a+l}px)`)}function f(){g(),p(),r.classList.remove("active")}function y(){g(),p(),r.classList.remove("active")}"mousedown"===t?(r.addEventListener("mousemove",v,!1),r.addEventListener("mouseup",y,!1),r.addEventListener("mouseleave",f,!1)):(r.addEventListener("touchmove",v,!1),r.addEventListener("touchend",y,!1),r.addEventListener("touchcancel",f,!1)),c=(e.changedTouches?e.changedTouches[0]:e).pageX-r.offsetLeft,r.classList.add("active")}}s(1);(new u).start()},function(e,t){}]);
//# sourceMappingURL=app.bundle.js.map